
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Revo API Factoring Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;ruby--tab&quot;,&quot;java&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="ruby--tab">Ruby</a>
              <a href="#" data-language-name="java">Java</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#authorization" class="toc-h1 toc-link" data-title="authorization">Authorization</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#base-url-addresses" class="toc-h2 toc-link" data-title="base-url-addresses">Base URL addresses</a>
                  </li>
                  <li>
                    <a href="#authorization-parameters" class="toc-h2 toc-link" data-title="authorization-parameters">Authorization parameters</a>
                  </li>
                  <li>
                    <a href="#digital-signature-generation" class="toc-h2 toc-link" data-title="digital-signature-generation">Digital signature generation</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-methods" class="toc-h1 toc-link" data-title="api-methods">API Methods</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#registration" class="toc-h2 toc-link" data-title="registration">Registration</a>
                  </li>
                  <li>
                    <a href="#limit" class="toc-h2 toc-link" data-title="limit">Limit</a>
                  </li>
                  <li>
                    <a href="#checkout" class="toc-h2 toc-link" data-title="checkout">Checkout</a>
                  </li>
                  <li>
                    <a href="#schedule" class="toc-h2 toc-link" data-title="schedule">Schedule</a>
                  </li>
                  <li>
                    <a href="#status" class="toc-h2 toc-link" data-title="status">Status</a>
                  </li>
                  <li>
                    <a href="#change" class="toc-h2 toc-link" data-title="change">Change</a>
                  </li>
                  <li>
                    <a href="#cancel" class="toc-h2 toc-link" data-title="cancel">Cancel</a>
                  </li>
                  <li>
                    <a href="#finish" class="toc-h2 toc-link" data-title="finish">Finish</a>
                  </li>
                  <li>
                    <a href="#return" class="toc-h2 toc-link" data-title="return">Return</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#error-codes" class="toc-h1 toc-link" data-title="error-codes">Error codes</a>
          </li>
          <li>
            <a href="#testing" class="toc-h1 toc-link" data-title="testing">Testing</a>
          </li>
          <li>
            <a href="#revo-iframe-description" class="toc-h1 toc-link" data-title="revo-iframe-description">REVO iFrame description</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#client-registration" class="toc-h2 toc-link" data-title="client-registration">Client registration</a>
                  </li>
                  <li>
                    <a href="#client-authorization" class="toc-h2 toc-link" data-title="client-authorization">Client authorization</a>
                  </li>
                  <li>
                    <a href="#checkout-2" class="toc-h2 toc-link" data-title="checkout">Checkout</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#website-presentation" class="toc-h1 toc-link" data-title="website-presentation">Website presentation</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#iframe-generation" class="toc-h2 toc-link" data-title="iframe-generation">iFrame generation</a>
                  </li>
                  <li>
                    <a href="#818f499a59" class="toc-h2 toc-link" data-title="">Отображение доступного лимита</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://revo.ru/'>Revo.ru</a></li>
            <li><a href='https://revotechnology.github.io/api-factoring/'>API Documentation in Russian</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>API Factoring is based on the HTTPS protocol with JSON queries.</p>

<p>The documentation consists of 4 main parts:</p>

<ul>
<li>Authorization description, <a href="#api">API methods</a> and <a href="#cb76858662">error codes</a>.</li>
<li><a href="#iframe-revo">Revo iFrame description</a>.</li>
<li><a href="#5a291e242a">Visualisation on a partner website</a>.</li>
<li><a href="#db947828e5">Test manual</a>.</li>
</ul>
<h1 id='authorization'>Authorization</h1><h2 id='base-url-addresses'>Base URL addresses</h2><pre class="highlight javascript tab-javascript"><code><span class="nx">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://r.revoplus.ru/"</span>
<span class="nx">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://demo.revoplus.ru/"</span>
</code></pre>
<ol>
<li>To interact with Revo services, two base addresses are used:

<ul>
<li>https://r.revoplus.ru/ - the <code>production</code> address of the service.</li>
<li>https://demo.revoup.ru/ - the <code>demo</code> address of the service.</li>
</ul></li>
<li><code>BASE_URL</code> - переменная обозначающая базовый адрес.</li>
</ol>

<aside class="notice">
The connection is only supported via HTTPS protocol - when trying to connect via HTTP, error 404 will occur.
</aside>
<h2 id='authorization-parameters'>Authorization parameters</h2>
<blockquote>
<p>Parameters example</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">secret_key</span> <span class="o">=</span> <span class="s2">"098f6bcd4621d373cade4e832627b4f6"</span>
<span class="nx">STORE_ID1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="nx">STORE_ID2</span> <span class="o">=</span> <span class="mi">13</span>
</code></pre>
<ol>
<li>On Revo’s side a unique store identifier and a secret key are generated, which are transferred to the partner:

<ul>
<li><code>store_id</code> - unique store identifier. In most cases, at least two unique identifiers are generated: <code>STORE_ID1</code> is used for <code>Registration</code> and <code>Limit</code> methods. <code>STORE_ID2</code> - for all the other methods.</li>
<li><code>secret_key</code> - a secret key used when generating the digital signature for authentication of query parameters to protect the form from being launched by third parties. Key length is 8 bytes. Encryption algorithm is SHA1.</li>
</ul></li>
<li>For authorization, the partner sends POST query, using digital signature and unique store identifier <code>store_id</code>.</li>
<li>Examples of URL queries can be found in <a href="#api">API Methods</a> section.</li>
</ol>
<h2 id='digital-signature-generation'>Digital signature generation</h2>
<blockquote>
<p>Algorithm of digital signature generation</p>
</blockquote>
<pre class="highlight ruby tab-ruby--tab"><code><span class="nb">require</span> <span class="s1">'digest/sha1'</span>
<span class="n">secret_key</span> <span class="o">=</span> <span class="s1">'9fff8c602b08b00323567be0001480f6'</span>
<span class="n">data</span> <span class="o">=</span> <span class="s2">"{</span><span class="se">\"</span><span class="s2">order_id</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">FACTPRECHR152632</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">amount</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">8300.00</span><span class="se">\"</span><span class="s2">}"</span>
<span class="no">SIGNATURE</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">SHA1</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">secret_key</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The result of the encryption in the above example is &quot;cbfb21630cd585f59c3a50fc3365d8c26b97cd4e&quot;.</p>
</blockquote>
<pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Formatter</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="n">String</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="s">"098f6bcd4621d373cade4e832627b4f6"</span><span class="o">;</span> <span class="c1">// Это пример</span>
    <span class="kd">static</span> <span class="n">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"{\"callback_url\":\"https://shop.ru/revo/decision\",\"redirect_url\":\"https://shop.ru/revo/redirect\",\"current_order\":{\"sum\":\"7500.00\",\"order_id\":\"R001233\"},\"primary_phone\":\"9268180621\"}"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">String</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">encryptPassword</span><span class="o">(</span><span class="n">data</span> <span class="o">+</span> <span class="n">secret_key</span><span class="o">);</span> <span class="c1">// Тут всегда будет 40 символов по SHA1</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">signature</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">encryptPassword</span><span class="o">(</span><span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sha1</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">MessageDigest</span> <span class="n">crypt</span> <span class="o">=</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"SHA-1"</span><span class="o">);</span>
            <span class="n">crypt</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
            <span class="n">crypt</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">));</span>
            <span class="n">sha1</span> <span class="o">=</span> <span class="n">byteToHex</span><span class="o">(</span><span class="n">crypt</span><span class="o">.</span><span class="na">digest</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sha1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">byteToHex</span><span class="o">(</span><span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">hash</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Formatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Formatter</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">hash</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">formatter</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%02x"</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="n">formatter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>A secret key <code>secret_key</code> is added to the data string in json format. SHA1 algorithm is then used to the generate a string which forms a digital <code>signature</code>.</p>

<aside class="notice">
Please note, that the signature length will always be 40 symbols according to SHA1.
</aside>
<h1 id='api-methods'>API Methods</h1><h2 id='registration'>Registration</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">limit</span><span class="o">/</span><span class="n">auth?store_id</span><span class="o">=</span><span class="no">STORE_ID1</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>The method returns a URL to the iFrame in order to get the client&#39;s limit. Upon completion of the form a json response with information about client&#39;s limit is sent to the address specified in <code>callback_url</code>.</p>

<p>Depending on the information about the user in the Revo system the form will have a different number of steps (<code>primary_phone</code> has to be specified) - see more info on <a href="#iframe-revo">REVO iFrame description</a>.</p>

<aside class="success">
The personal data provided by the client on the partner's website should be sent in the query for autocompletion of the corresponding Revo iFrame data fields.
</aside>
<h3 id='parameters'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"callback_url"</span><span class="p">:</span> <span class="s">"https://shop.ru/revo/decision"</span><span class="p">,</span>
  <span class="s">"redirect_url"</span><span class="p">:</span> <span class="s">"https://shop.ru/revo/redirect"</span><span class="p">,</span>
  <span class="s">"primary_phone"</span><span class="p">:</span> <span class="s">"9268180621"</span><span class="p">,</span>
  <span class="s">"primary_email"</span><span class="p">:</span> <span class="s">"ivan@gmail.com"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R001233"</span>
  <span class="p">},</span>
  <span class="s">"person"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"first_name"</span><span class="p">:</span> <span class="s">"Петр"</span><span class="p">,</span>
    <span class="s">"surname"</span><span class="p">:</span> <span class="s">"Чернышев"</span><span class="p">,</span>
    <span class="s">"patronymic"</span><span class="p">:</span> <span class="s">"Александрович"</span><span class="p">,</span>
    <span class="s">"birth_date"</span><span class="p">:</span> <span class="s">"15.01.1975"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>callback_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> URL for Revo response with information about client&#39;s limit.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>redirect_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> URL for redirecting upon clicking the button &quot;Return to online store” in the Revo form.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>current_order</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the order.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Unique order number. Maximum 255 characters. A unique random string can be used.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>primary_phone</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>primary_email</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> Client’s email.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>person</strong><br> <font color="#939da3">object, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> The object containing information about the client.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>first_name</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>surname</strong><br> <font color="#939da3">sring, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s surname.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>patronymic</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client&#39;s patronymic.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>birth_date</strong><br> <font color="#939da3">object, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s birth date in <code>dd.mm.yyyy</code> format.</td>
</tr>
</tbody></table>
<h3 id='response-parameters'>Response Parameters</h3>
<blockquote>
<p>Response example in case of successful authentication.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"iframe_url"</span><span class="p">:</span> <span class="s">"https://r.revoplus.ru/form/v1/af45ef12f4233f"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left">Response code.</td>
</tr>
<tr>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">A short text description of the response.</td>
</tr>
<tr>
<td style="text-align: right"><strong>iframe_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">URL to the generated iFrame.</td>
</tr>
</tbody></table>

<p><a name="callback_url"></a></p>
<h3 id='callback-parameters'>callback parameters</h3>
<blockquote>
<p>Callback example in case of successful authentication.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"32423"</span><span class="p">,</span>
  <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">5000.00</span><span class="p">,</span>
  <span class="s">"mobile_phone"</span><span class="p">:</span> <span class="s">"89262341793"</span><span class="p">,</span>
  <span class="s">"email"</span><span class="p">:</span> <span class="s">"ivan@gmail.com"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Unique order number. Maximum 255 characters.</td>
</tr>
<tr>
<td style="text-align: right"><strong>decision</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Decision on instalments. In case of positive decision - <code>approved</code> (the order is waiting to be finalized). In case of negative decision - <code>declined</code>.</td>
</tr>
<tr>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left">Amount in rubles.</td>
</tr>
<tr>
<td style="text-align: right"><strong>mobile_phone</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
<tr>
<td style="text-align: right"><strong>email</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Client&#39;s email.</td>
</tr>
</tbody></table>

<aside class="success">
If `decision` is equal to `declined` the `amount` value will be zero.
</aside>
<h2 id='limit'>Limit</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">external</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">client</span><span class="o">/</span><span class="n">limit?store_id</span><span class="o">=</span><span class="no">STORE_ID1</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>The method for obtaining the client’s limit amount using his phone number. Not applicable for new customers.</p>
<h3 id='parameters-2'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"client"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"mobile_phone"</span><span class="p">:</span> <span class="s">"9031234567"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>client</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left">An object containing information about the client.</td>
</tr>
<tr>
<td style="text-align: right"><strong>mobile_phone</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
</tbody></table>
<h3 id='response-parameters-2'>Response Parameters</h3>
<blockquote>
<p>Response example in case of a returning customer</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"meta"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
  <span class="p">},</span>
  <span class="s">"client"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"mobile_phone"</span><span class="p">:</span> <span class="s">"9031234567"</span><span class="p">,</span>
    <span class="s">"limit_amount"</span><span class="p">:</span> <span class="s">"9500.00"</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"active"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case of a returning customer with installments products unavailable</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"meta"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
  <span class="p">},</span>
  <span class="s">"client"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"mobile_phone"</span><span class="p">:</span> <span class="s">"9031234567"</span><span class="p">,</span>
    <span class="s">"limit_amount"</span><span class="p">:</span> <span class="s">"6700.00"</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"inactive"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case of a new customer</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"meta"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
  <span class="p">},</span>
  <span class="s">"client"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"mobile_phone"</span><span class="p">:</span> <span class="s">"9031234567"</span><span class="p">,</span>
    <span class="s">"limit_amount"</span><span class="p">:</span> <span class="s">"0.00"</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"new"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left"><td colspan="2"> Response code.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> A short text description of the response.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>client</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the client.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>mobile_phone</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>limit_amount</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">The amount of funds available to the client in rubles.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>status</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">User status. Possible values:<br><code>active</code> - the installments product is available to the user; <br><code>inactive</code> - the installments product is unavailable to the user;<br><code>new</code> - a new user with installments product available.</td>
</tr>
</tbody></table>
<h2 id='checkout'>Checkout</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">precheck</span><span class="o">/</span><span class="n">auth?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>The method returns a URL to the iFrame for client&#39;s order registration. Upon completion of the form a json response with information about order registration is sent to the address specified in <code>callback_url</code>. In case of successful registration <code>amount</code> is withheld from clinent&#39;s funds in the Revo system.</p>

<p>Depending on the information about the user in the Revo system the form will have a different number of steps (<code>primary_phone</code> has to be specified) - see more info on <a href="#iframe-revo">REVO iFrame description</a>.</p>

<p>In case where prepayment is needed, there are 2 ways of prepayment implementation:
*   If prepayment is made prior to opening the iFrame, then the prepayment amount should be sent using <code>prepayment_amount</code>.
*   If prepayment is to be made after the iFrame is called, the corresponding setting on the Revo side is made. Parameter <code>skip_result_page</code> should be set as <code>true</code> and <code>redirect_url</code> should be set to the prepayment page, to which the client will be redirected upon the completion of registration in Revo iFrame.</p>

<aside class="success">
The personal data provided by the client on the partner's website should be sent in the query for autocompletion of the corresponding Revo iFrame data fields.
</aside>
<h3 id='parameters-3'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"callback_url"</span><span class="p">:</span> <span class="s">"https://shop.ru/revo/decision"</span><span class="p">,</span>
  <span class="s">"redirect_url"</span><span class="p">:</span> <span class="s">"https://shop.ru/revo/redirect"</span><span class="p">,</span>
  <span class="s">"primary_phone"</span><span class="p">:</span> <span class="s">"9268180621"</span><span class="p">,</span>
  <span class="s">"primary_email"</span><span class="p">:</span> <span class="s">"ivan@gmail.com"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R001233"</span><span class="p">,</span>
    <span class="s">"valid_till"</span><span class="p">:</span> <span class="s">"21.07.2018 12:08:01+03:00"</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">59499.00</span><span class="p">,</span>
    <span class="s">"prepayment_amount"</span><span class="p">:</span> <span class="mf">1000.00</span>
  <span class="p">},</span>
  <span class="s">"person"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"first_name"</span><span class="p">:</span> <span class="s">"Петр"</span><span class="p">,</span>
    <span class="s">"surname"</span><span class="p">:</span> <span class="s">"Чернышев"</span><span class="p">,</span>
    <span class="s">"patronymic"</span><span class="p">:</span> <span class="s">"Александрович"</span><span class="p">,</span>
    <span class="s">"birth_date"</span><span class="p">:</span> <span class="s">"15.01.1975"</span>
  <span class="p">},</span>
  <span class="s">"cart_items"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"sku"</span><span class="p">:</span> <span class="s">"1231"</span><span class="p">,</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Samsung Note 8"</span><span class="p">,</span>
    <span class="s">"price"</span><span class="p">:</span> <span class="mi">55999</span><span class="p">,</span>
    <span class="s">"quantity"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">"brand"</span><span class="p">:</span> <span class="s">"Samsung"</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"sku"</span><span class="p">:</span> <span class="s">"23543"</span><span class="p">,</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Чехол фирменный"</span><span class="p">,</span>
    <span class="s">"price"</span><span class="p">:</span> <span class="mi">3500</span><span class="p">,</span>
    <span class="s">"sale_price"</span><span class="p">:</span> <span class="mi">2999</span><span class="p">,</span>
    <span class="s">"quantity"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">"brand"</span> <span class="p">:</span> <span class="s">"Samsung"</span>
  <span class="p">}],</span>
  <span class="s">"skip_result_page"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="s">"additional_data"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Color"</span><span class="p">,</span>
    <span class="s">"value"</span><span class="p">:</span> <span class="s">"Black"</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Size"</span><span class="p">,</span>
    <span class="s">"value"</span><span class="p">:</span> <span class="s">"Large"</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>callback_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> URL for Revo response with information about client&#39;s limit.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>redirect_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> URL for redirecting upon clicking the button &quot;Return to online store” in the Revo form.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>current_order</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the order.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Unique order number. Maximum 255 characters. A unique random string can be used.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>valid_till</strong><br> <font color="#939da3">String, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">A period during which the order is considered to be valid (funds are withheld for this period of time). When this period expires, the order is cancelled. Format: <code>dd.mm.yyyy hh:mm:ss+hh:mm</code>, where <code>hh:mm</code> after &quot;+&quot; is the time zone relative to GMT. The default value is 24 hours.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>term</strong><br> <font color="#939da3">integer, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Installments period in months.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Total order amount in rubles.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>prepayment_amount</strong><br> <font color="#939da3">float, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">The amount already prepaid by the client in rubles.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>primary_phone</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>primary_email</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> Client’s email.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>person</strong><br> <font color="#939da3">object, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the client.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>first_name</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>surname</strong><br> <font color="#939da3">sring, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s surname.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>patronymic</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client&#39;s patronymic.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>birth_date</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s birth date in <code>dd.mm.yyyy</code> format.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>cart_items</strong><br> <font color="#939da3">object, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the order.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>sku</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Stock keeping unit.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>name</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>price</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product price.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>sale_price</strong><br> <font color="#939da3">float, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product price with discount (if any).</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>quantity</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product quantity.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>brand</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product brand.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>skip_result_page</strong><br> <font color="#939da3">bool, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> A flag that determines whether the results page of the iFrame will be displayed. The default value is <code>false</code>. <br><code>true</code> - upon successful registration completion the user is immediately redirected to <code>redirect_url</code>. <br><code>false</code> - upon successful registration completion the user is presented with result page.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>additional_data</strong><br> <font color="#939da3">object, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> An object containing additional order information.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>name</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Parameter name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>value</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Parameter value.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-3'>Response Parameters</h3>
<blockquote>
<p>Response example in case of successful authentication.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"iframe_url"</span><span class="p">:</span> <span class="s">"https://revo.ru/factoring/v1/form/6976174c5b6a1bb089d15b80e0a6afc62d4283fe"</span>
<span class="p">}</span>
</code></pre>
<!-- > Пример ответа при неуспешной аутентификации.

```jsonnet
{
  status: 20,
  message: "Order order_id missing",
}
``` -->

<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left">Response code.</td>
</tr>
<tr>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">A short text description of the response.</td>
</tr>
<tr>
<td style="text-align: right"><strong>iframe_url</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">URL to the generated iFrame.</td>
</tr>
</tbody></table>

<p><a name="callback_url"></a></p>
<h3 id='callback-parameters-2'>Callback parameters</h3>
<blockquote>
<p>Callback example in case of success order registration.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R107356"</span><span class="p">,</span>
  <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">6700.00</span><span class="p">,</span>
  <span class="s">"prepayment_amount"</span><span class="p">:</span> <span class="mf">1000.00</span><span class="p">,</span>
  <span class="s">"total_amount"</span><span class="p">:</span> <span class="mf">7700.00</span><span class="p">,</span>
  <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s">"client"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"primary_phone"</span><span class="p">:</span> <span class="s">"8880010203"</span>
    <span class="s">"email"</span><span class="p">:</span> <span class="s">"ivan@gmail.com"</span><span class="p">,</span>
    <span class="s">"full_name"</span><span class="p">:</span> <span class="s">"Иванов Иван Иванович"</span><span class="p">,</span>
    <span class="s">"first_name"</span><span class="p">:</span> <span class="s">"Иван"</span><span class="p">,</span>
    <span class="s">"surname"</span><span class="p">:</span> <span class="s">"Иванов"</span><span class="p">,</span>
    <span class="s">"patronymic"</span><span class="p">:</span> <span class="s">"Иванович"</span>
  <span class="p">},</span>
  <span class="s">"schedule"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.01.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.02.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.03.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> Unique order number. Maximum 255 characters. A unique random string can be used.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>decision</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> Decision on instalments. In case of positive decision - <code>approved</code> (the order is waiting to be finalized). In case of negative decision - <code>declined</code>.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left"><td colspan="2"> Amount in rubles withheld from client&#39;s Revo account.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>prepayment_amount</strong><br> <font color="#939da3">float, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> The amount already prepaid by the client in rubles.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>total_amount</strong><br> <font color="#939da3">float, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> Total order amount, including prepayment.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>term</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left"><td colspan="2"> Installments period in months.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>client</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the client.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>primary_phone</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s phone number consisting of 10 digits (omitting the country code).</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>primary_email</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client’s email.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>full_name</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client&#39;s full name: last name, first name and patronymic diveded by spaces.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>first_name</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Cleint&#39;s first name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>surname</strong><br> <font color="#939da3">sring</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client&#39;s last name.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>patronymic</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Client&#39;s patronymic.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>schedule</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> Object containing information about the payment schedule.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>date</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment date in <code>dd.mm.yyyy</code> format.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment amount in rubles.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>monthly_overpayment</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left"><td colspan="2"> Monthly overpayment amount in rubles.</td>
</tr>
</tbody></table>

<aside class="success">
If `decision` is equal to `declined` then `amount` is zero and `schedule` is a empty object.
</aside>
<h2 id='schedule'>Schedule</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">schedule?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>The method returns information on the available preliminary payment schedules for the specified purchase price.</p>
<h3 id='parameters-4'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">5000.00</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left">Amount in rubles withheld from client&#39;s Revo account.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-4'>Response Parameters</h3>
<blockquote>
<p>Response example in case when 2 payment schedules are available: 3 and 6 months.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"payment_schedule"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"total"</span><span class="p">:</span> <span class="mf">7000.01</span><span class="p">,</span>
    <span class="s">"monthly_payment"</span><span class="p">:</span> <span class="mi">2334</span><span class="p">,</span>
    <span class="s">"monthly_overpayment"</span><span class="p">:</span> <span class="mf">666.67</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">"payment_dates"</span><span class="p">:</span>
    <span class="p">[{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"11.06.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2334.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.07.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2334.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.08.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2332.01</span>
    <span class="p">}]</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"total"</span><span class="p">:</span> <span class="mi">6500</span><span class="p">,</span>
    <span class="s">"monthly_payment"</span><span class="p">:</span> <span class="mi">1100</span><span class="p">,</span>
    <span class="s">"monthly_overpayment"</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s">"payment_dates"</span><span class="p">:</span>
    <span class="p">[{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"11.06.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1100.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.07.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1100.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.08.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1100.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"10.09.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1100.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.10.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1100.00</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">"date"</span><span class="p">:</span> <span class="s">"09.11.2018"</span><span class="p">,</span>
      <span class="s">"amount"</span><span class="p">:</span> <span class="mf">1000.00</span>
    <span class="p">}]</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left"><td colspan="3"> A short text description of the response.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>payment_schedule</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: right"></td>
<td style="text-align: left"><td colspan="3">    Object containing information about the payment schedule.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>total</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"><td colspan="2" style="text-align:left"> Total order amount, including overpayment.</td>
<td style="text-align: left"></td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>monthly_payment</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"><td colspan="2" style="text-align:left"> Monthly payment amount in rubles.</td>
<td style="text-align: left"></td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>monthly_overpayment</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"><td colspan="2" style="text-align:left"> Monthly overpayment amount in rubles.</td>
<td style="text-align: left"></td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>term</strong><br> <font color="#939da3">int</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"><td colspan="2" style="text-align:left">    Installments period in months.</td>
<td style="text-align: left"></td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>payment_dates</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"><td colspan="2" style="text-align:left">    Object containing information about the payment schedule.</td>
<td style="text-align: left"></td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="3" style="text-align:right"><strong>date</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment date in <code>dd.mm.yyyy</code> format.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="3" style="text-align:right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment amount in rubles.</td>
<td style="text-align: left"></td>
</tr>
</tbody></table>
<h2 id='status'>Status</h2><pre class="highlight ruby tab-ruby"><code> <span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">status?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>The method returns information on the order status.</p>
<h3 id='parameters-5'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code> <span class="p">{</span>
   <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R107356"</span>
 <span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Unique order number. Maximum 255 characters. A unique random string can be used.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-5'>Response Parameters</h3>
<blockquote>
<p>Response example in case when the client has completed the registration process (Revo iFrame) and is awaiting the Partner response</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTPRECHR00004768"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"hold"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">4999.0</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case when the client has completed the registration process (Revo iFrame) and the Parter has cancelled the order.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTPRECHR00004768"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"canceled"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mi">4999</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case when the client has completed the registration process (Revo iFrame) and the Partner has confirmed the order.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTR00004755"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"finished"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case when the order was declined by Revo</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTPRECHR00004721"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"declined"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"declined"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mi">6498</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="kc">null</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case when funds withholding period has elapsed. The order is cancelled.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTPRECHR141531"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"expired"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mi">9000</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Response example in case when the client has completed the registration process (Revo iFrame) and the Partner has confirmed the order. Then the order has been returned.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"current_order"</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"FACTPRECHR00004714"</span><span class="p">,</span>
    <span class="s">"expired"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s">"status"</span><span class="p">:</span> <span class="s">"refunded"</span><span class="p">,</span>
    <span class="s">"decision"</span><span class="p">:</span> <span class="s">"approved"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">734.51</span><span class="p">,</span>
    <span class="s">"term"</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left"><td colspan="2"> Response code.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> A short text description of the response.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>current_order</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the order.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Unique order number. Maximum 255 characters. A unique random string can be used.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>expired</strong><br> <font color="#939da3">bool</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Flag showing the current order status (funds withholding). The value is <code>false</code> for valid orders and <code>true</code> for expired orders (<code>valid_till</code> date and time has come).</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>status</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Order status information. Possible values:<br> <code>pending</code>, <code>hold</code>, <code>finished</code>, <code>canceled</code>, <code>declined</code>, <code>refunded</code>.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>decision</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Decision on instalments. In case of positive decision - <code>approved</code> (the order is waiting to be finalized). In case of negative decision - <code>declined</code>.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Total order amount in rubles.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>term</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Installments period in months.</td>
<td style="text-align: left"></td>
</tr>
</tbody></table>
<h3 id='status-and-decision-values'>Status and Decision values</h3>
<table><thead>
<tr>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left"><strong>Decision</strong></td>
<td style="text-align: left"><strong>Status</strong></td>
<td style="text-align: left"><strong>Description</strong></td>
</tr>
<tr>
<td style="text-align: left"><code>null</code></td>
<td style="text-align: left"><code>pending</code></td>
<td style="text-align: left">Client hasn&#39;t completed the registration form. There is no decision yet.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>hold</code></td>
<td style="text-align: left">Client&#39;s limit is approved, funds are withheld and the order is avaiting finalization.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>finished</code></td>
<td style="text-align: left">Order is finalized. In case of subsequent expiration or in case of partial return this status doesn&#39;t change.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>canceled</code></td>
<td style="text-align: left">Order is cancelled. In case of subsequent expiration this status doesn&#39;t change.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>expired</code></td>
<td style="text-align: left">Client&#39;s limit is approved, order expired.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>refunded</code></td>
<td style="text-align: left">Order was fully refunded. In case of partial return <code>status</code> is qual to <code>finished</code>.</td>
</tr>
<tr>
<td style="text-align: left"><code>approved</code></td>
<td style="text-align: left"><code>declined</code></td>
<td style="text-align: left">Client&#39;s limit is approved, installments product is unavailable to the client (order amount is above client&#39;s limit).</td>
</tr>
<tr>
<td style="text-align: left"><code>declined</code></td>
<td style="text-align: left"><code>declined</code></td>
<td style="text-align: left">Client&#39;s limit is declined by Revo.</td>
</tr>
</tbody></table>
<h2 id='change'>Change</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">precheck</span><span class="o">/</span><span class="n">change?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>Method for changing an order.</p>
<h3 id='parameters-6'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R107356"</span><span class="p">,</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">59999.00</span><span class="p">,</span>
  <span class="s">"valid_till"</span><span class="p">:</span> <span class="s">"29.07.2018 12:08:01+03:00"</span>
  <span class="s">"cart_items"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"sku"</span><span class="p">:</span> <span class="s">"1231"</span><span class="p">,</span>
    <span class="s">"name"</span><span class="p">:</span> <span class="s">"Samsung Note 8"</span><span class="p">,</span>
    <span class="s">"price"</span><span class="p">:</span> <span class="mi">55999</span><span class="p">,</span>
    <span class="s">"quantity"</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> Unique order number. Maximum 255 characters. A unique random string can be used.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left"><td colspan="2">   Total order amount in rubles.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>valid_till</strong><br> <font color="#939da3">String, <em>optional</em></font></td>
<td style="text-align: left"><td colspan="2"> A period during which the order is considered to be valid (funds are withheld for this period of time). When this period expires, the order is cancelled. Format: <code>dd.mm.yyyy hh:mm:ss+hh:mm</code>, where <code>hh:mm</code> after &quot;+&quot; is the time zone relative to GMT. The default value is 24 hours.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>cart_items</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> An object containing information about the order.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>sku</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Stock keeping unit.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>name</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product name.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>price</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product price.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>sale_price</strong><br> <font color="#939da3">float, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product price in case of discount (if available).</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>quantity</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product quantity.</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"> <strong>brand</strong><br> <font color="#939da3">string, <em>optional</em></font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Product brand.</td>
<td style="text-align: left"></td>
</tr>
</tbody></table>
<h3 id='response-parameters-6'>Response parameters</h3>
<blockquote>
<p>Response example in case of successful change.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span><span class="p">,</span>
  <span class="s">"schedule"</span><span class="p">:</span>
  <span class="p">[{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.01.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.02.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s">"date"</span><span class="p">:</span> <span class="s">"01.03.2018"</span><span class="p">,</span>
    <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2933.33</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left"><td colspan="2"> Response code.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left"><td colspan="2"> A short text description of the response.</td>
</tr>
<tr>
<td style="text-align: right"></td>
<td style="text-align: right"><strong>schedule</strong><br> <font color="#939da3">object</font></td>
<td style="text-align: left"><td colspan="2"> Object containing information about the payment schedule.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>date</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment date in <code>dd.mm.yyyy</code> format.</td>
</tr>
<tr>
<td style="text-align: right"><td colspan="2" style="text-align:right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: right"></td>
<td style="text-align: left">Payment amount in rubles.</td>
</tr>
</tbody></table>
<h2 id='cancel'>Cancel</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">precheck</span><span class="o">/</span><span class="n">cancel?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>Method for order cancellation. The whitheld amount of client&#39;s funds is unblocked upon cancellation.</p>
<h3 id='parameters-7'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R107356"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Unique order number. Maximum 255 characters. A unique random string can be used.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-7'>Response Parameters</h3>
<blockquote>
<p>Response example in case of successful order cancellation.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left">Response code.</td>
</tr>
<tr>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">A short text description of the response.</td>
</tr>
</tbody></table>
<h2 id='finish'>Finish</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">precheck</span><span class="o">/</span><span class="n">finish?store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>Method for finalizing the order by transferring the sales contract to Revo. The query content type is <code>multipart/form-data</code>. Two keys have to be specified in the query: the first one named &#39;body&#39; that contains the json query and the second one named <code>check</code> where the file (fiscal document, i.e. receipt) is attached. <code>Signature</code> is formed in the usual way - without the second key.</p>

<aside class="notice">
Finilizing an order that has already been expired will result in execution of `Cancel` method.
</aside>
<h3 id='parameters-8'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R107356"</span><span class="p">,</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">6700.00</span><span class="p">,</span>
  <span class="s">"check_number"</span><span class="p">:</span> <span class="s">"ZDDS3123F"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Unique order number. Maximum 255 characters.</td>
</tr>
<tr>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left">Amount in rubles.</td>
</tr>
<tr>
<td style="text-align: right"><strong>check_number</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Fiscal document number according to Partner&#39;s system (i.e. receipt number).</td>
</tr>
</tbody></table>
<h3 id='response-parameters-8'>Response Parameters</h3>
<blockquote>
<p>Response example in case of successful document upload.</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left">Response code.</td>
</tr>
<tr>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">A short text description of the response.</td>
</tr>
</tbody></table>
<h2 id='return'>Return</h2><pre class="highlight ruby tab-ruby"><code><span class="no">POST</span> <span class="no">BASE_URL</span><span class="o">/</span><span class="n">factoring</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="k">return</span><span class="p">?</span><span class="n">store_id</span><span class="o">=</span><span class="no">STORE_ID2</span><span class="o">&amp;</span><span class="n">signature</span><span class="o">=</span><span class="no">SIGNATURE</span>
</code></pre>
<p>Method for performing a full or partial return. Only a finalized order can be returned. For unfinalized orders <a href="#cancel">Cancel</a> method has to be used. Partial returns are available starting from the next day after finalization. Client&#39;s funds are fully reimbursed including any overpayments at any given point in time until the end of installments payment period.</p>
<h3 id='parameters-9'>Parameters</h3>
<blockquote>
<p>Json query example</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"R001233"</span><span class="p">,</span>
  <span class="s">"amount"</span><span class="p">:</span> <span class="mf">2010.00</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>order_id</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">Unique order number. Maximum 255 characters.</td>
</tr>
<tr>
<td style="text-align: right"><strong>amount</strong><br> <font color="#939da3">float</font></td>
<td style="text-align: left">Amount to be returned in rubles. A return can either be full or partial.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-9'>Response Parameters</h3>
<blockquote>
<p>Json response example in case of successful return</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"Payload valid"</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Json response example in case of unsuccessful return</p>
</blockquote>
<pre class="highlight jsonnet tab-jsonnet"><code><span class="p">{</span>
  <span class="s">"status"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s">"message"</span><span class="p">:</span> <span class="s">"JSON decode error"</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th style="text-align: right"></th>
<th style="text-align: left"></th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>status</strong><br> <font color="#939da3">integer</font></td>
<td style="text-align: left">Response code.</td>
</tr>
<tr>
<td style="text-align: right"><strong>message</strong><br> <font color="#939da3">string</font></td>
<td style="text-align: left">A short text description of the response.</td>
</tr>
</tbody></table>
<h1 id='error-codes'>Error codes</h1>
<table><thead>
<tr>
<th style="text-align: right">Code</th>
<th style="text-align: left">Message</th>
<th style="text-align: left">Comments</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: right"><strong>0</strong></td>
<td style="text-align: left">Payload valid</td>
<td style="text-align: left">Everything is OK.</td>
</tr>
<tr>
<td style="text-align: right"><strong>10</strong></td>
<td style="text-align: left">JSON decode error</td>
<td style="text-align: left">Incorrect json query.</td>
</tr>
<tr>
<td style="text-align: right"><strong>20</strong></td>
<td style="text-align: left">Order <code>order_id</code> missing</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>21</strong></td>
<td style="text-align: left">Wrong order <code>order_id</code> format</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>22</strong></td>
<td style="text-align: left">Order exists</td>
<td style="text-align: left">Order with specified <code>order_id</code> already exist and is finalized.</td>
</tr>
<tr>
<td style="text-align: right"><strong>23</strong></td>
<td style="text-align: left">Order expired</td>
<td style="text-align: left">Order with specified <code>order_id</code> has expired.</td>
</tr>
<tr>
<td style="text-align: right"><strong>24</strong></td>
<td style="text-align: left">Order with specified id not found</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>30</strong></td>
<td style="text-align: left">Wrong order <code>order_sum</code> format</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>32</strong></td>
<td style="text-align: left">Order amount is different from the amount specified before</td>
<td style="text-align: left">Occurs when trying to finalize an order with incorrect <code>amount</code>.</td>
</tr>
<tr>
<td style="text-align: right"><strong>33</strong></td>
<td style="text-align: left">Order amount is outside of tariff_limits</td>
<td style="text-align: left">Order amount is outside of tariff limits specified for the partner.</td>
</tr>
<tr>
<td style="text-align: right"><strong>34</strong></td>
<td style="text-align: left">Order term value is wrong</td>
<td style="text-align: left">Incorrect <code>term</code> value is specified.</td>
</tr>
<tr>
<td style="text-align: right"><strong>35</strong></td>
<td style="text-align: left">Order prepayment amount is wrong</td>
<td style="text-align: left"><code>prepayment_amount</code> is greater than <code>amount</code>.</td>
</tr>
<tr>
<td style="text-align: right"><strong>40</strong></td>
<td style="text-align: left">Order <code>callback_url</code> missing</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>41</strong></td>
<td style="text-align: left">Order <code>redirect_url</code> missing</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>50</strong></td>
<td style="text-align: left">Store id is missing</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>51</strong></td>
<td style="text-align: left">Store not found</td>
<td style="text-align: left">Unable to find store with specified <code>store_id</code>.</td>
</tr>
<tr>
<td style="text-align: right"><strong>60</strong></td>
<td style="text-align: left"><code>Signature</code> missing</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>61</strong></td>
<td style="text-align: left"><code>Signature</code> wrong</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>62</strong></td>
<td style="text-align: left">Error saving file</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>70</strong></td>
<td style="text-align: left">Phone number is different</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>71</strong></td>
<td style="text-align: left">Client has not enough limit</td>
<td style="text-align: left">Client has insufficient funds for the specified order.</td>
</tr>
<tr>
<td style="text-align: right"><strong>80</strong></td>
<td style="text-align: left">Unable to finish - order is already finished/canceled</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>81</strong></td>
<td style="text-align: left">Unable to cancel - order is already finished/canceled</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>82</strong></td>
<td style="text-align: left">Unable to change - order is already finished/canceled</td>
<td style="text-align: left"></td>
</tr>
<tr>
<td style="text-align: right"><strong>90</strong></td>
<td style="text-align: left">Cart items are missing</td>
<td style="text-align: left">Unable to change order - no <code>cart_items</code> specified.</td>
</tr>
<tr>
<td style="text-align: right"><strong>100</strong></td>
<td style="text-align: left">At the moment the server cannot process your request</td>
<td style="text-align: left">Occurs in any other cases.</td>
</tr>
</tbody></table>
<h1 id='testing'>Testing</h1>
<p>Integration testing is performed on demo server (https://demo.revoplus.ru). As demo server does send SMS messages, it&#39;s recommended to use an inexistent 888 phone prefix, so that no SMS messages are sent to real people. It&#39;s not allowed to use 888 prefix on production server.</p>

<p>All confirmation codes and pin codes are <code>8888</code>.</p>

<ul>
<li><p>In order to get a negative decision upon <a href="#Registration"><code>Registration</code></a> a phone number starting with 88821 has to be used.</p></li>
<li><p>In order to get a positive decision upon <a href="#Registration"><code>Registration</code></a> a phone number starting with 888 has to be used, except for 88821.</p></li>
<li><p>Confirmation code for production server is set up in settings on Revo side (might be different from 8888).</p></li>
<li><p>Full name + date of birth or passport number is checked for an existing client. This has to be taken into account when testing.</p></li>
</ul>
<h1 id='revo-iframe-description'>REVO iFrame description</h1><h2 id='client-registration'>Client registration</h2>
<blockquote>
<p><a href="Registration.png" target="new"> <img src="Registration.png"></a></p>
</blockquote>

<p>1-2. Form completion.<br>
3. SMS code entry and phone number verification screen.<br>
3.1 In case of an error in the mobile phone number the client can change the phone number on the corresponding screen. <br>
4.1 Upon entering the correct sms code, &quot;The registration was successful&quot; screen is displayed. Client&#39;s available limit is displayed on this screen.<br>
4.2 Alternatively the &quot;Unfortunately, installments product is not available to you” screen is displayed.<br></p>

<p>The first Revo iFrame screen has the following personal information data fields:</p>

<ul>
<li>Last name</li>
<li>First name</li>
<li>Patronymic</li>
<li>Date of birth</li>
<li>Mobile phone number</li>
<li>Email</li>
<li>Passport number</li>
</ul>

<p>Validation:</p>

<ul>
<li> Last name, first name and patroniФимилия are only accepted as cyrillic characters, <code>string</code> data type.</li>
<li> Date of birth is entered in <code>dd.mm.yyyy</code> format, <code>date</code> data type.</li>
<li> Mobile phone number is entered in 10 digit format as (888)1231212, <code>string</code> data type.</li>
<li> Email, <code>string</code> data type.</li>
<li> Passport number has to be of exactly 10 symbols, <code>string</code> data type.</li>
</ul>

<aside class="notice">
It's possible to prefill the first screen using json query.
</aside>
<h2 id='client-authorization'>Client authorization</h2>
<blockquote>
<p><a href="Authentication.png" target="new"> <img src="Authentication.png"></a></p>
</blockquote>

<ol>
<li>Login button click on the first screen. <br>
2.1 Mobile phone entry and &quot;Send SMS&quot; button click.<br>
2.2 If no such mobile phone number is found in the database, the &quot;We haven&#39;t found you with the specified phone number&quot; screen is presented. Clicking on the &quot;Register in 1 minute&quot; button presents the first screen.<br>
3.1 If a mobile phone number is found in the database, the SMS code confirmation screen is presented. <br>
3.2 In case of an error in the mobile phone number the client can change the phone number on the corresponding screen. <br>
4.1 Upon entering the correct SMS code, &quot;The registration was successful&quot; screen is displayed. Client&#39;s available limit is displayed on this screen.<br>
4.2 Alternatively the &quot;Unfortunately, installments product is not available to you” screen is displayed.<br></li>
</ol>

<!-- ><a href="FAQ.png" target="new"> <img src="FAQ.png" size="50%"></a> -->

<p>А list of frequently asked questions is displayed in the upper right corner of the form when clicking on the FAQ button.</p>

<aside class="notice">
A 30-minute session is created upon client authorization. During the session the client will be directly transferred to the results page of any iFrames.
</aside>

<aside class="notice">
In case the client hasn’t completed the registration form before the `valid_till` period expires, an error message will be presented "Unfortunately, order reservation period has expired.".
</aside>
<h2 id='checkout-2'>Checkout</h2>
<blockquote>
<p><a href="Checkout.png" target="new"> <img src="Checkout.png"></a></p>
</blockquote>

<ol>
<li>Form completion. <br>
2.1 Mobile phone entry and &quot;Send SMS&quot; button click.<br>
2.2 In case of an error in the mobile phone number the client can change the phone number on the corresponding screen. <br>
3.1 In case prepayment is not required a screen with term selection is presented. <br>
3.2 In case prepayment is required a screen with term selection and prepayment amount slider is presented. <br>
4.1 In case of successful checkout without prepayment a &quot;Checkout successful&quot; screen is presented with a button to return to the Parter web site. <br>
4.2 Alternatively the &quot;Unfortunately, installments product is not available to you” screen is displayed. <br>
4.3 In case of successful checkout with prepayment a &quot;Checkout successful&quot; screen is presented with a button that opens Parter&#39;s payment page.<br>
4.4 Alternatively the &quot;Unfortunately, installments product is not available to you” screen is displayed.<br></li>
</ol>
<h1 id='website-presentation'>Website presentation</h1>
<p>Recommendations on how to present Revo installments product on a Partner web site are available <a href="REVO Presentation.pdf" target="new">here</a>. Implementation of individual elements is described below.</p>
<h2 id='iframe-generation'>iFrame generation</h2><pre class="highlight javascript tab-javascript"><code><span class="nx">REVO</span><span class="p">.</span><span class="nx">Form</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">iframe_url</span><span class="p">,</span> <span class="nx">target_selector</span><span class="p">);</span>
</code></pre>
<p>Revo Registration iFrame has to be called when any of the following buttons are clicked: &quot;Register in 1 minute&quot;, &quot;?&quot; to right from &quot;or 150 Rub/month&quot;. Revo Checkout iFrame has to be called when &quot;Pay with REVO&quot; button is clicked on the checkout page. That is performed by generating a link with <a href="#Registration"><code>Registration</code></a> or <a href="#Checkout"><code>Checkout</code></a> methods and sending the link to a js method from Revo plugin.</p>

<p><code>iframe_url</code> – iFame URL, obligatory parameter.
<code>target_selector</code> – element selector that will contain the iFrame.</p>

<p>Revo JS plugin then inserts <code>&lt;iframe src= iframe_url /&gt;</code> and processed iFrame operations.</p>

<p>Plugin is available at the following address: <code>https://{BASE_URI}/javascripts/iframe/v2/revoiframe.js</code>.</p>
<pre class="highlight html tab-html"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://{BASE_URI}/javascripts/iframe/v2/revoiframe.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
<p>Plugin also supports the following events: form closed - <code>onClose</code>, form loaded - <code>onLoad</code>, decision made - <code>onResult</code>.</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">REVO</span><span class="p">.</span><span class="nx">Form</span><span class="p">.</span><span class="nx">onClose</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s1">'closed'</span><span class="p">);</span> <span class="p">});</span>
<span class="nx">REVO</span><span class="p">.</span><span class="nx">Form</span><span class="p">.</span><span class="nx">onLoad</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'frame loaded'</span><span class="p">);</span> <span class="p">});</span>
<span class="nx">REVO</span><span class="p">.</span><span class="nx">Form</span><span class="p">.</span><span class="nx">onResult</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'result'</span><span class="p">);</span> <span class="p">});</span>
</code></pre>
<aside class="success">
In case when iFrame has to opened on a separate page `iframe_url` has to be called directly. Background is adjustable on Revo side.
</aside>
<h2 id='818f499a59'>Отображение доступного лимита</h2>
<p>Funds available to the already registered client might be obtained using the <a href="#limit">Limit</a> method.</p>

<!--
# Тестирование и отладка

## Тестовые Параметры

Тестовые мобильные номера для ввода в <a href="#iframe-revo">iframe</a>:

`8881ХХХХXX` - одобрено всё (второе оформление = повторная заявка)

`88821ХХХХХ` - отказано полностью

`88822ХХХХХ` - одобрены только займ

Код для подтверждения номера телефона - `8888`

<aside class="notice">
Данные параметры предназначены только для demo сервиса.
</aside>

## Кейсы для тестирования

### Подробное описание вызова формы для регистрации клиента.

> Пример формирования signature на ruby:

```ruby--tab
data = {
"callback_url": "https://shop.ru/revo/decision",
"redirect_url": "https://shop.ru/revo/redirect",
"primary_phone": "9268180621",
"primary_email": "ivan@gmail.com",
"current_order":
{
 "order_id": "R001233"
}}
 => {:callback_url=>"https://shop.ru/revo/decision", :redirect_url=>"https://shop.ru/revo/redirect", :primary_phone=>"9268180621", :primary_email=>"ivan@gmail.com", :current_order=>{:order_id=>"R001233"}}

 data = data.to_json
 => "{\"callback_url\":\"https://shop.ru/revo/decision\",\"redirect_url\":\"https://shop.ru/revo/redirect\",\"primary_phone\":\"9268180621\",\"primary_email\":\"ivan@gmail.com\",\"current_order\":{\"order_id\":\"R001233\"}}"

 secret_key = "9fff8c602b08b00323567be0001480f6"

 signature = Digest::SHA1.hexdigest(secret_key + data)
 => "347e8cff27d30b5200c8b32def4365ebbf4270d0"

puts data
{"callback_url":"https://shop.ru/revo/decision","redirect_url":"https://shop.ru/revo/redirect","primary_phone":"9268180621","primary_email":"ivan@gmail.com","current_order":{"order_id":"R001233"}}

```

Для вызова формы используется метод <a href="#registration">registration</a>.

> Пример отправки запроса через API CLIENT:

><a href="rest_client.png" target="new"> <img src="rest_client.png"></a>

 Необходимые параметры для вызова формы:

* базовый URL сервиса для тестирования и отладки
* store_id
* signature

Описание формирования запроса на получение ссылки вызова iframe:

* В переменную `data` вводится тело json запроса
* Переводим `data` в `json` формат
* В переменную `secret_key` вводим наименование ключа
* В переменную `signature` формируем подпись
* Выводим тело `json` запроса через команду `puts` для отправки запроса через клиент

Данные для отправки запроса в REST CLIENT:

Используется POST URL:
`https://demo.revoup.ru/factoring/v1/limit/auth?store_id=72&signature=347e8cff27d30b5200c8b32def4365ebbf4270d0`

Тело JSON:
`{"callback_url":"https://shop.ru/revo/decision","redirect_url":"https://shop.ru/revo/redirect","primary_phone":"9268180621","primary_email":"ivan@gmail.com","current_order":{"order_id":"R001233"}}`



### Подробное описание отправки запроса на финализацию заказа

> Пример формирования signature на ruby:

```ruby--tab
data = {order_id: "FACTPRECHR00005384", amount: 4999.0, check_number: "sdfhk"}
 => {:order_id=>"FACTPRECHR00005384", :amount=>4999.0, :check_number=>"sdfhk"}
data = data.to_json
 => "{\"order_id\":\"FACTPRECHR00005384\",\"amount\":4999.0,\"check_number\":\"sdfhk\"}"
secret_key = "9fff8c602b08b00323567be0001480f6"
 => "9fff8c602b08b00323567be0001480f6"
signature = Digest::SHA1.hexdigest(data + secret_key)
 => "70189f8a4f413fcb01c8933cae50f4341fe8fdee"
2.3.3 :012 > puts data
{"order_id":"FACTPRECHR00005384","amount":4999.0,"check_number":"sdfhk"}

```
>Пример запроса через REST клиент POSTMAN:

><a href="post_finish.png" target="new"> <img src="post_finish.png"></a>


Для финализации заказа используется метод <a href="#finish">finish</a>

Необходимые параметры для финализации заказа:

* базовый URL для тестирования и отладки
* store_id
* signature

Описание формирования запрос на финализацию заказа:

* В переменную `data` вводится тело json запроса
* Переводим   `data` в `json` формат
* В переменную `secret_key` вводим наименование ключа
* В переменную  `signature` формируем подпись
* Выводим тело `json` запроса через команду `puts` для отправки запроса через клиент

Данные для отправки запроса в REST CLIENT:

Используется POST URL:
`https://demo.revoup.ru/factoring/v1/precheck/finish?store_id=72&signature=70189f8a4f413fcb01c8933cae50f4341fe8fdee`

Тело JSON с key = body:
`{"order_id":"FACTPRECHR00005384","amount":4999.0,"check_number":"sdfhk"}`

Приложение фискального документа с key = check.



## Особенности

>Кейс 1

><a href="approve.png" target="new"> <img src="approve.png"></a><a href="declined_fio_dr.png" target="new"> <img src="declined_fio_dr.png"></a>

### Логика взаимодействия ввода персональных данных при оформлении заказа в iframe


Кейс 1:

* Ввод в анкету существующего в базе Рево ФИО + Дата рождения или Паспортные данные + Номер телефона, который не существует в базе Рево.

Что происходит:

* Клиента переводит на окно с подтверждением кода из смс. Если клиент подтверждает код из смс, то происходит переход на окно с результатом. В результате отображается информационное сообщение о необходимости подтверждения данных клиента.

Кейс 2:

* Ввод существующего номера телефона и фио клиента. Ввод паспортных данных и даты рождения не соответствует данным клиента.

Что происходит:

* Клиента переводит на окно подтверждения кода из смс. Если клиент подтверждает код из смс, то происходит переход на окно с корзиной и графиком платежей. Далее переход на окно с результатом, где отображается информационное сообщение об успешном оформлении. (Подробнее в описание <a href="#ee363a7d6e"> Оформление покупки</a>) -->

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="ruby--tab">Ruby</a>
                <a href="#" data-language-name="java">Java</a>
          </div>
      </div>
    </div>
  </body>
</html>
